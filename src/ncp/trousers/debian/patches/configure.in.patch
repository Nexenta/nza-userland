Index: trousers-0.3.4/configure.in
===================================================================
--- trousers-0.3.4.orig/configure.in	2011-04-07 00:45:29.545584860 +0400
+++ trousers-0.3.4/configure.in	2011-04-07 00:54:17.253019584 +0400
@@ -14,10 +14,9 @@
 AM_INIT_AUTOMAKE([foreign 1.6])
 
 # Debugging support
-AC_ARG_ENABLE(debug,
-		AC_HELP_STRING([--enable-debug], [turn on all trousers debugging flags [default is off]]),
-		[enable_debug="yes"
-		 AC_MSG_RESULT([*** Enabling debugging at user request ***])],)
+AC_ARG_ENABLE([debug],
+    [AC_HELP_STRING([--enable-debug], [turn on all trousers debugging flags [default=off]])],
+    AC_MSG_RESULT([*** Enabling debugging at user request ***]),)
 
 # If the user has not set CFLAGS, do something appropriate
 test_CFLAGS=${CFLAGS+set}
@@ -39,6 +38,9 @@
         *ppc64* | *powerpc64* | *x86_64*)
 		CFLAGS="$CFLAGS -m64"
 		;;
+	*solaris*)
+		CFLAGS="$CFLAGS -DSOLARIS"
+		;;
         *)
                 ;;
 esac
@@ -347,7 +349,16 @@
 AC_PROG_CC
 AC_PROG_LIBTOOL
 
-CFLAGS="$CFLAGS -W -Wall -Werror -Wno-unused-parameter -Wsign-compare \
+AC_C_BIGENDIAN([AC_DEFINE(_BIG_ENDIAN, 1, [big-endian host])])
+AC_CHECK_HEADER(endian.h, [AC_DEFINE(HAVE_ENDIAN_H, 1, [endian.h header])])
+AC_CHECK_HEADER(sys/byteorder.h, [AC_DEFINE(HAVE_BYTEORDER_H, 1, [sys/byteorder.h header])])
+AC_CHECK_FUNC(daemon, [ AC_DEFINE(HAVE_DAEMON, 1, [daemon function is available]) ])
+ 
+if test "x${GCC}" = "xyes"; then
+	CFLAGS="$CFLAGS -W -Wall -Werror -Wno-unused-parameter -Wsign-compare"
+fi
+
+CFLAGS="$CFLAGS -I../include \
 	-DTCSD_DEFAULT_PORT=${TCSD_DEFAULT_PORT} -DTSS_VER_MAJOR=${TSS_VER_MAJOR} \
 	-DTSS_VER_MINOR=${TSS_VER_MINOR} -DTSS_SPEC_MAJOR=${TSS_SPEC_MAJOR} \
 	-DTSS_SPEC_MINOR=${TSS_SPEC_MINOR}"
