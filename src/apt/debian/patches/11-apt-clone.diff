--- apt-0.8.10.3+squeeze1.orig/doc/apt-clone.8.xml
+++ apt-0.8.10.3+squeeze1/doc/apt-clone.8.xml
@@ -0,0 +1,185 @@
+<?xml version="1.0" encoding="utf-8" standalone="no"?>
+<!DOCTYPE refentry PUBLIC "-//OASIS//DTD DocBook XML V4.2//EN"
+  "http://www.oasis-open.org/docbook/xml/4.2/docbookx.dtd" [
+
+<!ENTITY % aptent SYSTEM "apt.ent">
+%aptent;
+
+<!ENTITY % aptverbatiment SYSTEM "apt-verbatim.ent">
+%aptverbatiment;
+
+]>
+
+<refentry>
+
+ <refentryinfo>
+   &apt-author.jgunthorpe;
+   &apt-author.team;
+   &apt-email;
+   &apt-product;
+   <!-- The last update date -->
+   <date>3 January 2008</date>
+ </refentryinfo>
+ 
+ <refmeta>
+   <refentrytitle>apt-clone</refentrytitle>
+   <manvolnum>8</manvolnum>
+    <refmiscinfo class="manual">APT</refmiscinfo>    
+ </refmeta>
+ 
+ <!-- Man page title -->
+ <refnamediv>
+    <refname>apt-clone</refname>
+    <refpurpose>ZFS integrated APT package handling utility -- command-line interface</refpurpose>
+ </refnamediv>
+
+ <!-- Arguments -->
+ <refsynopsisdiv>
+   <cmdsynopsis>
+      <command>apt-clone</command>
+      <arg><option>-hltsyv</option></arg>
+      <arg><option>-a=<replaceable>clone-name</replaceable></option></arg>
+      <arg><option>-r=<replaceable>clone-name</replaceable></option></arg>
+      <arg><option>-b=<replaceable>bootmenu-count</replaceable></option></arg>
+      <arg><option>-k=<replaceable>clone-count</replaceable></option></arg>
+      <arg><option>-x=<replaceable>http-proxy</replaceable></option></arg>
+      <arg><option>apt-cmd</option></arg>
+      <arg choice="plain" rep="repeat"><replaceable>pkg1 pkg2</replaceable></arg>
+   </cmdsynopsis>
+ </refsynopsisdiv>
+ 
+ <refsect1><title>Description</title>
+   <para><command>apt-clone</command> is the command-line tool for handling packages, and may be 
+   considered the user's "front-end" to the &apt-get;. It manages GRUB menu and ZFS 'syspool' filesystems. Two
+   upgrade methods supported: 1) safe upgrades via cloning a currently active filesystem and later chrooting into it to
+   perform actual upgrade operation; 2) in-place (live) upgrades by checkpointing a currently active filesystem prior to
+   any upgrade modifications done by apt-get utility. The live upgrading, as the name implies, happens in-place on
+   the running system, and without reboot. Unless the safe <option>-s</option> option is explicitly specified,
+   the system will automatically detect whether the upgrade will require reboot, and if so, it will clone the
+   active filesystem and safely perform the software upgrade within this ZFS clone. A user then has two
+   options: reboot into the new (upgraded) system folder or continue working (and possibly activate
+   the upgrade and reboot into it later).
+   </para>
+
+   <para>Nexenta clone name format is 'syspool/rootfs-nmu-###', where ### is zeroes started decimal number
+   (i.e. 'slot') precaculated during upgrade.</para>
+
+   <para>Safe upgrade is done in specially prepared chroot environment and do not disturbs running services. Upgrade checkpointing is ZFS clone created prior to upgrade modifications to the active root filesystem.</para>
+
+   <para>The default behavior (i.e. when no command line options given) of apt-clone utility is this:
+   1) detect set of packages which needs to be upgraded;
+   2) verify if &dpkg; or &apt-get; needs to be upgraded, and upgrade them unconditionally;
+   3) calculate free space which is required by the upgrade and compare with what is available in ZFS pool named 'syspool';
+   4) verify if at least one of the core packages (i.e. 'sunwcakr', 'sunwkvm', 'sunwcsr', 'sunwckr', 'sunwcnetr', 'sunwcsu', 'sunwcsd' or 'sunwcsl') requires upgrade, and if so, than enable safe upgrade option by using specially prepared chroot environment. See <option>-s</option> option for details;
+   5) if no core packages requires upgrade, do upgrade checkpointing which is simply ZFS clone created prior to upgrade modifications done by &apt-get; utility;
+   6) run &apt-get; for all or only provided set of packages.</para>
+
+   <para>If the <option>-h</option>, or <option>--help</option> option is given, other options
+   will be disregarded.</para>
+ </refsect1>
+ 
+ <refsect1><title>options</title>
+
+   <variablelist>
+     <varlistentry><term><option>apt-cmd</option></term>
+     <listitem><para>One of the apt-get commands: upgrade, dist-upgrade, install, remove or autoremove
+     </para></listitem>
+     </varlistentry>
+
+     <varlistentry><term><option>-l</option></term>
+     <listitem><para>List upgraded clones; ZFS clones for system pool 'syspool' as
+     they listed in GRUB menu.</para></listitem>
+     </varlistentry>
+
+     <varlistentry><term><option>-i</option></term>
+     <listitem><para>Initiate application rollback checkpoint; ZFS clone which could be used to
+     rollback folowing modifications made by human or application.</para></listitem>
+     </varlistentry>
+
+     <varlistentry><term><option>-a clone-name</option></term>
+     <listitem><para>Activate given ZFS clone name; GRUB menu default will set to
+     given clone name.</para></listitem>
+     </varlistentry>
+
+     <varlistentry><term><option>-r clone-name</option></term>
+     <listitem><para>Rollback/Destroy upgrade changes for ZFS clone name; only non-active and non-default ZFS clone
+     could be rolled back. Upgrade rollback means destroy of clone which is no longer in use, such as failed upgrade or
+     custom checkpoint.</para></listitem>
+     </varlistentry>
+
+     <varlistentry><term><option>-b bootmenu-count</option></term>
+     <listitem><para>Maximum number of GRUB's boot menu entries to keep; retention policy, default is 16.</para></listitem>
+     </varlistentry>
+
+     <varlistentry><term><option>-k clone-count</option></term>
+     <listitem><para>Maximum number of cloned ZFS root filesystems to keep; retention policy, default is 32.</para></listitem>
+     </varlistentry>
+
+     <varlistentry><term><option>-x http-proxy</option></term>
+     <listitem><para>Remote repository HTTP proxy server; See &apt-get; for more details.</para></listitem>
+     </varlistentry>
+
+     <varlistentry><term><option>-t</option></term>
+     <listitem><para>Dry-run. Perform simulated upgrade; do not change data on system volume. Upgrade
+     checkpoint will not be created.</para></listitem>
+     </varlistentry>
+
+     <varlistentry><term><option>-s</option></term>
+     <listitem><para>Safe upgrade in cloned ZFS root filesystem; using chroot environment, do not disturbs currently
+     running system and services, requires reboot, could be used to force upgrade in chroot environment
+     for normal (i.e. non-core) packages. The default behavior is to create checkpoint for non-core packages or use
+     safe upgrade option for core packages. It is not possible to disable safe upgrade if one of core packages
+     detected in calculated dependencies.</para></listitem>
+     </varlistentry>
+
+     <varlistentry><term><option>-y</option></term>
+     <listitem><para>Do not ask any questions, assume Yes to all questions.</para></listitem>
+     </varlistentry>
+
+     <varlistentry><term><option>-v</option></term>
+     <listitem><para>Verbose output.</para></listitem>
+     </varlistentry>
+
+     <varlistentry><term><option>-h</option></term>
+     <listitem><para>Show a short usage summary.</para></listitem>
+     </varlistentry>
+     
+   </variablelist>
+ </refsect1>
+
+ <refsect1><title>Files</title>
+   <variablelist>
+     <varlistentry><term><filename>/etc/apt/sources.list</filename></term>
+     <listitem><para>Locations to fetch packages from.</para></listitem>
+     </varlistentry>
+     
+     <varlistentry><term><filename>/boot/grub/menu.lst</filename></term>
+     <listitem><para>GRUB configuration file.</para></listitem>
+     </varlistentry>
+   </variablelist>
+ </refsect1>
+
+ <refsect1><title>See Also</title>
+   <para>&apt-get;, &apt-cache;, &apt-cdrom;, &dpkg;, &dselect;, &sources-list;,
+   &apt-conf;, &apt-config;, &apt-secure;, 
+   The APT User's guide in &guidesdir;, &apt-preferences;, the APT Howto.</para>
+ </refsect1>
+
+ <refsect1><title>Diagnostics</title>
+   <para><command>apt-clone</command> returns '0' on normal operation, decimal '1' on error.</para>
+ </refsect1>
+
+ <refsect1><title>Bugs</title>
+   <para><ulink url='https://bugs.launchpad.net/~nexenta'>Nexenta bug page</ulink>. 
+   </para>
+ </refsect1>
+
+ <refsect1><title>Author</title>
+   <para>APT was written by the APT team <email>apt@packages.debian.org</email>.
+   apt-clone utility written and maintained by Nexenta team <email>nexenta-devel@nexenta.org</email>.
+   </para>
+ </refsect1>
+
+    &manbugs;
+     
+</refentry>
